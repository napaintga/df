<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cypress Secure Image: Linker Scripts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cypress Secure Image
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_secure_image_linker_scripts.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Linker Scripts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Custom linker scripts are used for the CM0+ secure image and the sample user application CM0+ and CM4 images.</p>
<p>These are modified versions of the default linker scripts provided by the PDL. Linker scripts for the three supported toolchains GCC (.ld), ARMCC (.scat) and IAR (.icf) are provided.</p>
<h1><a class="anchor" id="group_secure_image_link_secure"></a>
Secure Image Linker Script</h1>
<p>The specifics of the secure image (CM0+ only) are as follows:</p>
<ul>
<li>Starting Flash address of the secure application is located at the start of the Flash region 0x10000000. The application object is 0x10000 Bytes.</li>
<li>The public key (sflash_public_key), TOC2 (sflash_toc2) and RTOC2 (sflash_rtoc2) are populated in the secure image.</li>
<li>Secure image RAM is located at the start of the SRAM region 0x08000000 and its size is 0x2000 Bytes.</li>
<li>The secure image application header (cy_app_header) is located at the start of the application Flash (0x10000000) and the application signature (cy_app_signature) is located at the end of the application Flash (0x1000FF00).</li>
<li>The main stack is located an the last 4K of RAM (0x08001000 - 0x08001FFF).</li>
</ul>
<h1><a class="anchor" id="group_secure_image_link_user"></a>
User App Linker Script</h1>
<p>The user application has custom linkers scripts for both the CM0+ core and the CM4 core. The specifics of the CM0+ linker script are as follows:</p>
<ul>
<li>The CM0+ application Flash is located at 0x10020000 - 0x1002FFFF.</li>
<li>The CM0+ RAM is located at 0x08010000 and is 0x10000 Bytes.</li>
<li>The application object (CM0+ and CM4) header is located at the beginning of the image Flash.</li>
<li>The application digital signature is defined in the CM4 linker script as it needs to be located at the end of the application object as defined in the application header.</li>
</ul>
<p>The specifics of the CM4 linker script are as follows:</p>
<ul>
<li>The CM4 application Flash is located at 0x10080000 - 0x1008FFFF.</li>
<li>The CM4 RAM is located at 0x08020000 and is 0x10000 Bytes.</li>
<li>The application object (CM0+ and CM4) digital signature is located at the end of the image Flash.</li>
<li>The application digital signature is generated by defining two symbols: __cy_app_verify_start (0x10020000) and __cy_app_verify_length (0x0006ff00). This instructs cymcuelftool to begin the signature calculation from the location defined at __cy_app_verify_start up to the address offset defined by __cy_app_verify_length.</li>
</ul>
<h1><a class="anchor" id="group_secure_image_elf"></a>
Using cymcuelftool</h1>
<p>The cymcuelftool is used in this design for three purposes:</p>
<ul>
<li>Generate the assembly file containing the export symbols using the &ndash;codeshare (-R) command.</li>
<li>Populate the footer/signature region with the application digital signature. This is accomplished by using the &ndash;sign (-S) command.</li>
<li>Merge the (secure image CM0+, user app CM0+ and CM4) applications. This is accomplished by using the &ndash;merge (-M) command.</li>
</ul>
<p>The cymcuelftool relies on correct symbols and sections to be defined in the generated elf file in order to be able to correctly execute the &ndash;sign command.</p>
<ul>
<li>The section "cy_app_header" must be defined.</li>
<li>The "cy_app_signature" symbol must be defined to generate the digital signature.</li>
<li>The symbols "__cy_app_verify_start" and "__cy_app_verify_length" must be used to define the start and length of the memory region to calculate the digital signature. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>Cypress Secure Image</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
