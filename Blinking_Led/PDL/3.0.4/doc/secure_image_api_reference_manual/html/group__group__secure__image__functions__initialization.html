<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cypress Secure Image: Initialization Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cypress Secure Image
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__group__secure__image__functions__initialization.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Initialization Functions<div class="ingroups"><a class="el" href="group__group__secure__image__functions.html">Functions</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">General Description</h2>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1d9df3739c936d9b5eb6734687c249bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__secure__image__functions__initialization.html#ga1d9df3739c936d9b5eb6734687c249bb">Cy_SI_ValidateImage</a> (uint32_t *validToc)</td></tr>
<tr class="memdesc:ga1d9df3739c936d9b5eb6734687c249bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates the user image using SHA-256 and RSA-2048.  <a href="#ga1d9df3739c936d9b5eb6734687c249bb">More...</a><br /></td></tr>
<tr class="separator:ga1d9df3739c936d9b5eb6734687c249bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafba1dcd41b46a9313d183ccb627b49a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__secure__image__functions__initialization.html#gafba1dcd41b46a9313d183ccb627b49a8">Cy_SI_ConfigCrypto</a> (void)</td></tr>
<tr class="memdesc:gafba1dcd41b46a9313d183ccb627b49a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the Crypto server.  <a href="#gafba1dcd41b46a9313d183ccb627b49a8">More...</a><br /></td></tr>
<tr class="separator:gafba1dcd41b46a9313d183ccb627b49a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa564b9b24daa790a044616111b37113e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__secure__image__functions__initialization.html#gaa564b9b24daa790a044616111b37113e">Cy_SI_ConfigSysCall</a> (void)</td></tr>
<tr class="memdesc:gaa564b9b24daa790a044616111b37113e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the SysCall interrupt.  <a href="#gaa564b9b24daa790a044616111b37113e">More...</a><br /></td></tr>
<tr class="separator:gaa564b9b24daa790a044616111b37113e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27c7533f33cad985449340dab5dd6842"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__secure__image__functions__initialization.html#ga27c7533f33cad985449340dab5dd6842">Cy_SI_ConfigProt</a> (void)</td></tr>
<tr class="memdesc:ga27c7533f33cad985449340dab5dd6842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the protection units for the secure image.  <a href="#ga27c7533f33cad985449340dab5dd6842">More...</a><br /></td></tr>
<tr class="separator:ga27c7533f33cad985449340dab5dd6842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5da82ec4d681c047f5f7d5753a7425a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__group__secure__image__functions__initialization.html#gac5da82ec4d681c047f5f7d5753a7425a">Cy_SI_CheckMemRange</a> (uint32_t beginAddr, uint32_t endAddr, uint32_t checkType)</td></tr>
<tr class="memdesc:gac5da82ec4d681c047f5f7d5753a7425a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that the referenced memory is not in the protected regions.  <a href="#gac5da82ec4d681c047f5f7d5753a7425a">More...</a><br /></td></tr>
<tr class="separator:gac5da82ec4d681c047f5f7d5753a7425a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1d9df3739c936d9b5eb6734687c249bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d9df3739c936d9b5eb6734687c249bb">&#9670;&nbsp;</a></span>Cy_SI_ValidateImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a> Cy_SI_ValidateImage </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>validToc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates the user image using SHA-256 and RSA-2048. </p>
<p>This function uses the same validation scheme used by Flash boot to verify the authenticity of the user application. SHA-256 is used to generate the user application Hash, which is encrypted using RSA-2048 and a private key to generate the digital signature. The validation scheme uses the RSA-2048 public key in SFlash to decrypt the digital signature and compare it with the SHA-256 Hash of the application object.</p>
<dl class="section note"><dt>Note</dt><dd>This function requires that the user application is constructed in Cypress application format. It references a validation routine in SFlash, which is designed to only work with RSA.</dd>
<dd>
If an error is encountered in Flash boot while operating in NORMAL or SECURE_with_DEBUG modes, a debugger can be attached and the SRAM address defined by the CY_SI_FLASHBOOT_ERROR_ADDR macro can be used to determine the source of the error.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Status of the image validation. </dd></dl>

</div>
</div>
<a id="gafba1dcd41b46a9313d183ccb627b49a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafba1dcd41b46a9313d183ccb627b49a8">&#9670;&nbsp;</a></span>Cy_SI_ConfigCrypto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a> Cy_SI_ConfigCrypto </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures the Crypto server. </p>
<p>This function initializes and starts the Crypto server, which accepts and executes all valid Crypto operation requests. These routines are executed by the Crypto IP with the aid of CM0+ in the secure domain of the secure image.</p>
<dl class="section note"><dt>Note</dt><dd>The entire Crypto library is included in the secure image by default. If only a subset is required by the client application, choose a smaller library to reduce the size of the secure image.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Status of the crypto server configuration </dd></dl>

</div>
</div>
<a id="gaa564b9b24daa790a044616111b37113e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa564b9b24daa790a044616111b37113e">&#9670;&nbsp;</a></span>Cy_SI_ConfigSysCall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a> Cy_SI_ConfigSysCall </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures the SysCall interrupt. </p>
<p>SysCall IPC requests are by default configured to generate an NMI on the CM0+ core. This is serviced by code residing in ROM. In order to apply pre-processing to the SysCall request in the secure image, the IPC-NMI connection must be broken and the interrupt vector reconfigured.</p>
<dl class="section return"><dt>Returns</dt><dd>Status of the SysCall configuration </dd></dl>

</div>
</div>
<a id="ga27c7533f33cad985449340dab5dd6842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga27c7533f33cad985449340dab5dd6842">&#9670;&nbsp;</a></span>Cy_SI_ConfigProt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a> Cy_SI_ConfigProt </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the protection units for the secure image. </p>
<p>This function configures the bus master capabilities and initializes the protection units for the secure image. It enables them and locks out the configurations from being reconfigured by PC!=0 bus masters. All invalid accesses will generate faults.</p>
<p>Bus master Configuration:</p><ul>
<li>CM0+ : Only allow PC=0</li>
<li>Crypto : Only allow PC=0</li>
<li>DW0 : Ignored - DW0 inherits the client's config</li>
<li>DW1 : Ignored - DW1 inherits the client's config</li>
<li>CM4 : Allow all PC except PC=0</li>
<li>TC : Allow all PC except PC=0</li>
</ul>
<p>The function also provides IPC protection unit configurations as reference to be used by the Client software; The IPC_STRUCT and IPC_STRUCT registers need to be shared between us masters and it is the client's responsibility to configure them. The data to be passed through the IPC_STRUCT.DATA register also should be protected using an SMPU.</p>
<dl class="section note"><dt>Note</dt><dd>The protection unit evaluation is prioritized in a descending order. i.e. Higher index is evaluated before a lower index protection unit.</dd>
<dd>
All master protection units are enabled and configured to only allow PC=0 bus masters to reconfigure their respective slave protection units. This is to prevent unwanted configuration of higher priority protection units, which can override the lower priority protection unit settings. Refer to the TRM for more information on the protection unit priorities.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Status of protection unit configuration. </dd></dl>

</div>
</div>
<a id="gac5da82ec4d681c047f5f7d5753a7425a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac5da82ec4d681c047f5f7d5753a7425a">&#9670;&nbsp;</a></span>Cy_SI_CheckMemRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__group__secure__image__enums.html#ga6025974f2b3c35c6c074fb5b664a7813">cy_en_si_status_t</a> Cy_SI_CheckMemRange </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>beginAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>endAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>checkType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks that the referenced memory is not in the protected regions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">beginAddr</td><td>The beginning address used to access the interested memory. For example, the first address of an array.</td></tr>
    <tr><td class="paramname">endAddr</td><td>The end address used to access the interested memory. For example, the last address of an array.</td></tr>
    <tr><td class="paramname">checkType</td><td>The type of access to be evaluated by the function call.<ul>
<li>CY_SI_MEM_TYPE_FLASH_DST_MASK: The memory access is intended to be used in writing to a Flash row.</li>
<li>CY_SI_MEM_TYPE_FLASH_SRC_MASK: The memory access is intended to be used in reading from Flash.</li>
<li>CY_SI_MEM_TYPE_RAM_MASK: The memory access is intended for accessing RAM.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Status of the memory check. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>Cypress Secure Image</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
